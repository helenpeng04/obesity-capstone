---
title: "Does physical inactivity level and access to healthy food affect obesity rate
  at the county level?"
author: "Jordan"
date: "2025-06-23"
output: html_document
---

```{r}
library(readxl)
library(tidyverse)

data_2024 <- read_excel("C:/Users/jorda/Desktop/Capstone Obesity/2024_CHRD.xlsx", sheet = "Select Measure Data", skip = 1)

data_2025 <- read_excel("C:/Users/jorda/Desktop/Capstone Obesity/2025_CHRD.xlsx", sheet = "Select Measure Data", skip = 1)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
table(data_2024$Unreliable...4)
```

## Including Plots

You can also embed plots, for example:

```{r}
library(patchwork)  # For combining plots

# PHYSICAL INACTIVITY ANALYSIS
state_inactivity <- data_2024 |> 
  select(State, County, `% Physically Inactive`) |> 
  filter(!is.na(State), !is.na(`% Physically Inactive`)) |> 
  group_by(State) |> 
  summarize(inactivity_rate = mean(`% Physically Inactive`, na.rm = TRUE)) |> 
  rename(state = State) |> 
  arrange(inactivity_rate)

# Physical Inactivity Map
inactivity_map <- plot_usmap(data = state_inactivity, values = "inactivity_rate", regions = "states") +
  scale_fill_continuous(
    low = "lightblue", high = "navy",
    name = "Inactivity Rate (%)",
    limits = c(15, 35)  # Adjust based on your data range
  ) +
  labs(title = "Physical Inactivity Rates by State (2024)") +
  theme(legend.position = "right")

# FOOD ENVIRONMENT INDEX ANALYSIS
state_food <- data_2024 |> 
  select(State, County, `Food Environment Index`) |> 
  filter(!is.na(State), !is.na(`Food Environment Index`)) |> 
  group_by(State) |> 
  summarize(food_index = mean(`Food Environment Index`, na.rm = TRUE)) |> 
  rename(state = State) |> 
  arrange(food_index)

# Food Environment Index Map (higher values = better food access)
food_map <- plot_usmap(data = state_food, values = "food_index", regions = "states") +
  scale_fill_continuous(
    low = "darkred", high = "darkgreen",
    name = "Food Index Score",
    limits = c(3, 9)  # Typical range for Food Environment Index
  ) +
  labs(title = "Food Environment Index by State (2024)") +
  theme(legend.position = "right")

# Display maps side by side
inactivity_map + food_map

# COUNTY-LEVEL SCATTERPLOTS (Relationship with Obesity)
county_data <- data_2024 |> 
  select(State, County, 
         obesity = `% Adults with Obesity`,
         inactivity = `% Physically Inactive`,
         food_index = `Food Environment Index`) |> 
  filter(!is.na(obesity), !is.na(inactivity), !is.na(food_index))

# Inactivity vs Obesity
ggplot(county_data, aes(x = inactivity, y = obesity)) +
  geom_point(alpha = 0.3, color = "blue") +
  geom_smooth(method = "lm", color = "navy") +
  labs(title = "County-Level: Physical Inactivity vs Obesity",
       x = "Physical Inactivity Rate (%)",
       y = "Obesity Rate (%)") +
  theme_minimal()

# Food Index vs Obesity (note: lower index = worse food access)
ggplot(county_data, aes(x = food_index, y = obesity)) +
  geom_point(alpha = 0.3, color = "darkgreen") +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "County-Level: Food Environment vs Obesity",
       x = "Food Environment Index (Higher = Better Access)",
       y = "Obesity Rate (%)") +
  theme_minimal()
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
